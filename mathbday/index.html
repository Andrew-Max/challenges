
<!DOCTYPE html>
<html>
<head>
	<title>Math B-Day</title>
	
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.css" />

 	<link href="https://fonts.googleapis.com/css?family=Oswald" rel="stylesheet">

	<style media="screen" type="text/css">
		* {
			font-family: 'Oswald', sans-serif;
		}

		.navbar {
			background-color: #444;
			border: none;
			border-radius: 0;
		}
		.navbar p {
			margin: 5px 0 0 0;
			font-size: 28px;
			color: #69d8a1;
		}

		.content-body {
			margin: 10px;
		}

		.input-container {
			margin: 10px 0 0 0;
		}
		.input-container input {
			width: 240px;
			margin-bottom: 10px;
		}

		.result-container {
			margin-top: 20px;
			display: none;
		}
		.result-container button.extras-show {
			background: #69d8a1;
		}
		.result-container button.extras-show:hover {
			background: #19ff8d;
		}
		.result-container button.extras-hide {
			display: none;
		}
		.advanced-results {
			margin-top: 20px;
			display: none;
		}

		.input-field {
			width: 240px;
			position: relative;
		}
		.input-field .close{
			position: absolute;
			top: 9px;
			right: 10px;
			font-size: 16px;
		}
		.input-field .close:hover{
			color: red;
		}

		.errors-container {
			display: none;
			margin-top: 20px;
		}

		.errors-container .error {
			color: red;
		}
	</style>
</head>
<body>

	<nav class="navbar navbar-default">
	  <div class="container-fluid">
	      	<p>Math Birthday</p>
	  </div>
	</nav>

	<div class="content-body container-fluid">
		<div class="row">
			<div class="input-container">
				<div class="input-field">
					<input type="text" class="form-control" id="datepicker" name="birthday">
					<span class="close">Reset</span>
				</div>

				<button class="btn btn-primary">Submit</button>
			</div>
			<div class="result-container">
				<div class="main-result">
					<p>Your next Math Birthday is your <span class="next-bday-days"></span>-day-old birthday in <span class="days-till"></span> days on <span class="next-bday-date"></span></p>

					<button class="extras-show btn">Show Advanced Math Bday Info</button>
					<button class="extras-hide btn btn-danger">Hide Advanced Math Bday Info</button>
				</div>

				<div class="advanced-results">
					<ul>
						<li>You are <span class="days-old"></span> days old.</li>
						<li>Your last Math Birthday was your <span class="last-bday-days"></span>-day-old birthday</li>
						<li>Your last Math Birthday was<span class="days-since-last"></span> days ago</li>
						<li>Your Last Math Birthday was on <span class="last-bday-date"></span></li>
						<li class="1-day"></li>
						<li class="10-day"></li>
						<li class="100-day"></li>
						<li class="1000-day"></li>
						<li class="10000-day"></li>
						<li class="100000-day"></li>
					</ul>
				</div>

			</div>
			<div class="errors-container">
				<p class="error"></p>
			</div>
		</div>
</body>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>

<script type="text/javascript">
//=============================
// Main function
//=============================
$( document ).ready(function() {
    initializeDatepicker();
    $('.input-container button').on('click', handleBdayInput);
    $('.input-container .close').on('click', handleInputReset);
    $('.result-container button.extras-show').on('click', handleToggleExtras);
    $('.result-container button.extras-hide').on('click', handleToggleExtras);


});


//=============================
//Data Caculation
//=============================
function calcReturnData(date) {
	// turn to actual object
	var returnObj = {}

	var presetsObj = createPresetsObj(date);
	returnObj.nextBDay = calcNextMathBDay(presetsObj);
	returnObj.lastBDay = calcLastMathBDay(presetsObj);
	returnObj.extras = calcExtras(presetsObj);
	return returnObj;
};

function createPresetsObj(date) {
	// turn to actual object
	var presetsObj = {
		date: date,
		birthday: function() {
			return moment(this.date, 'MM-DD-YYYY')
		},
		numCurrentDays: function () {
			return moment().diff(this.birthday(), "days")
		},
		currentDaysCharLength: function () {
			return this.numCurrentDays().toString().length;
		}
	};

	return presetsObj;
};

function calcNextMathBDay(presetsObj) {
  // turn to actual object
  var nextMathBDayObj = {
	dayOfNextMathBDay: function() {
		return Math.pow(10, presetsObj.currentDaysCharLength());
	},
	daysTillNextMathBDay: function() {
		return this.dayOfNextMathBDay() - presetsObj.numCurrentDays();
	},
	nextMathBDayDate: function() {
		var nextMathBDayDate = moment().add(this.daysTillNextMathBDay(), 'days');
		return nextMathBDayDate.format("dddd, MMMM Do YYYY");
	}
  };

  return nextMathBDayObj;
};

function calcLastMathBDay(presetsObj) {
	var lastMathBDayObj = {
		dayOfLastMathBDay: function() {
			return Math.pow(10, presetsObj.currentDaysCharLength() - 1);
		},
		daysSinceLastMathBDay: function() {
			return presetsObj.numCurrentDays() - this.dayOfLastMathBDay();
		},
		lastMathBDayDate: function () {
			var lastMathBDayDate = moment().subtract(this.daysSinceLastMathBDay(), 'days');
			return lastMathBDayDate.format("dddd, MMMM Do YYYY");
		}
	};

	return lastMathBDayObj;
};

function calcExtras(presetsObj) {
	var extrasObj = {
		currentDays: function() {
			return presetsObj.numCurrentDays();
		},
		BDay1: function() {
			return calcTimeDiffString(presetsObj, 1);
		},
		BDay10: function() {
			return calcTimeDiffString(presetsObj, 10);
		},
		BDay100: function() {
			return calcTimeDiffString(presetsObj, 100);
		},
		BDay1000: function() {
			return calcTimeDiffString(presetsObj, 1000);
		},
		BDay10000: function() {
			return calcTimeDiffString(presetsObj, 10000);
		},
		BDay100000: function() {
			return calcTimeDiffString(presetsObj, 100000);
		},
	}

	return extrasObj;
};

function calcTimeDiffString(presetsObj, bday) {
	var date = presetsObj.birthday().add(bday, "days");
	var isBeforeBirthday = date.isBefore(moment());
	var timeString = isBeforeBirthday ? "was " + date.fromNow() : "is " + date.fromNow();
	return "Your " + bday.toString() + " day Math Birthday " + timeString + " on " + date.format("dddd, MMMM Do YYYY");
}

//=============================
// Initialization
//=============================
function initializeDatepicker() {
	$("#datepicker").datepicker({
	    changeMonth: true,
	    changeYear: true,
	    yearRange: '-110:+0',
	    maxDate: new Date
	});
};


//=============================
// Event Handlers
//=============================
function handleBdayInput() {
	var bdayInput = $('.input-container input').val();

	if(bdayInput === "") {
	    return throwNoInputError();
	} else {
	    clearErrors();
	}

	var dataObj = calcReturnData(bdayInput);
	updateDOM(dataObj);
};

function handleInputReset() {
	$('.result-container').hide();
	$('.input-container input').val(null);
	clearErrors();
};

function handleToggleExtras() {
	$('.advanced-results').toggle();
	$('.result-container button.extras-show').toggle();
	$('.result-container button.extras-hide').toggle();
};


//=============================
//Errors
//=============================
function throwNoInputError() {
	$('.errors-container').show();
	$('.errors-container .error').html('Please Choose A Date Before Submitting');
};


//=============================
//Utility
//=============================
function clearErrors() {
	$('.errors-container').hide();
	$('.errors-container .error').html('');
};

function updateDOM(dataObj) {
	$('.result-container').show();
	$('.result-container span.next-bday-days').html(dataObj.nextBDay.dayOfNextMathBDay());
	$('.result-container span.days-till').html(dataObj.nextBDay.daysTillNextMathBDay());
	$('.result-container span.next-bday-date').html(dataObj.nextBDay.nextMathBDayDate());
	$('.result-container span.days-old').html(dataObj.extras.currentDays());
	$('.result-container span.last-bday-days').html(dataObj.lastBDay.dayOfLastMathBDay());
	$('.result-container span.days-since-last').html(dataObj.lastBDay.daysSinceLastMathBDay());
	$('.result-container span.last-bday-date').html(dataObj.lastBDay.lastMathBDayDate());
	$('.result-container .1-day').html(dataObj.extras.BDay1());
	$('.result-container .10-day').html(dataObj.extras.BDay10());
	$('.result-container .100-day').html(dataObj.extras.BDay100());
	$('.result-container .1000-day').html(dataObj.extras.BDay1000());
	$('.result-container .10000-day').html(dataObj.extras.BDay10000());
	$('.result-container .100000-day').html(dataObj.extras.BDay100000());
};	
</script>

</html>
